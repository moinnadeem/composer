---
name: rte-pareto-curves  # Name of the sweep - it'll be used in run names
project: rte-pareto-curves  # Name of the Weights and Biases project to use
image: mosaicml/moin  # Name of the docker image to use
git_repo: https://github.com/moinnadeem/composer.git  # Name of the git repo to clone - can be full URL or path under github.com
git_branch: moin/cleaned_gated  # Name of the git branch/tag/commit to use
command: >-
  source ~/env/bin/activate

  pip install wheel

  git clone {{ git_repo }} /root/composer

  cd /root/composer

  pip install xformers

  echo 'Checking out composer branch {{ git_branch }}'

  git checkout {{ git_branch }}

  pip install -e ".[all]"

  composer -n {{ parameters['_n_gpus'] }} examples/run_composer_trainer.py
  -f /mnt/config/parameters.yaml --run_name $(WANDB_NAME)
instance: r1z1-g1-a100  # Name of the instance you want to run on, e.g. r1z1-g8-a100
run_type: convergence  # Type of run you want to perform (convergence is default and only one support currently)
algorithms:
  - act_fn_search
models: rte  # The name of the model you want to use - should match the name of a YAML file in your local composer "models" directory unless you are fully specifying model parameters in the `parameters` section
parameters:  # Any parameter overrides you want to use IN EVERY RUN should be specified here
  run_name: rte-relu-gated
  _n_gpus: 1
  grad_accum: 1
  algorithms:
    act_fn_search:
      use_gated: true
      use_rmsnorm: false
      use_fln: false
      use_triton: false
      act_fn_name: relu
      w0_bias: true
      w1_bias: false
named_like: moin-bert-relu-gated-w0-true-w1-false
grid:
  seed:
    - 4
    - 5
  load_path:
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba3500-rank0-wct2013/checkpoints/ep5-ba40910-rank0-wct5587
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba14000-rank0-wct7929/checkpoints/ep5-ba40910-rank0-wct5535
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba24500-rank0-wct13848/checkpoints/ep5-ba40910-rank0-wct5606
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba35000-rank0-wct19763/checkpoints/ep5-ba40910-rank0-wct5537
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba45500-rank0-wct25680/checkpoints/ep5-ba40910-rank0-wct5532
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba56000-rank0-wct31618/checkpoints/ep5-ba40910-rank0-wct5561
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep0-ba66500-rank0-wct37670/checkpoints/ep5-ba40910-rank0-wct5557
    - https://storage.googleapis.com/moin_bert_checkpoints/moin-bert-relu-gated-w0-true-w1-false/ep1-ba68796-rank0-wct39106/checkpoints/ep5-ba40910-rank0-wct5578
